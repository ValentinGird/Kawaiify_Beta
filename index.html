<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Kawaiify</title>
        <!-- Favicon -->
        <link rel="icon" type="image/png" href="https://i.ibb.co/XZJbQPYm/favicon-32x32.png">
        <!-- Google Analytics Tag -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-87691MFX3P"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'G-87691MFX3P', { 'debug_mode': true });
        </script>
        <!-- End Google Analytics Tag -->
        <style>
            /* Dark mode */
            * {
            box-sizing: border-box;
            }
            html, body {
            height: 100%;
            margin: 0;
            display: flex;
            flex-direction: column;
            }
            body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: Arial, sans-serif;
            text-align: center;
            flex-grow: 1;
            }
            .container {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            padding-bottom: 50px; /* Leave space for the footer */
            }
            /* Profile banner */
            .banner {
            background-color: #333;
            color: #fff;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            flex-direction: column;
            }
            .banner img {
            border-radius: 50%;
            width: 80px;
            height: 80px;
            margin-bottom: 10px;
            }
            .banner h2 {
            font-size: 1.5em;
            margin: 0;
            color: #FF69B4; /* Flashy pink for the title */
            }
            .banner p {
            font-size: 1em;
            margin-top: 5px;
            }
            /* Grid for offers layout */
            .offers {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            justify-items: center; /* Center the elements in the grid */
            align-items: stretch; /* Ensure elements have the same height */
            margin-bottom: 0px; /* Réduction maximale sans être collé */
            padding-bottom: 0px !important; /* Supprime tout padding en bas */
            }
            /* Offer */
            .offer {
            background-color: #1e1e1e;
            border: 1px solid #444;
            border-radius: 10px;
            padding: 20px;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 400px; /* Limit width to avoid large blocks on PC */
            height: 100%; /* Ensure all sections have the same height */
            margin-bottom: 10px; /* Réduction de l’espace en dessous */
            }
            .offer h2 {
            color: #FF69B4; /* Flashy pink for the titles */
            font-size: 1.8em;
            }
            .offer img {
            width: 100%;
            max-height: 500px; /* Limite la hauteur de l'image */
            object-fit: cover; /* Adapte l'image sans la déformer */
            border-radius: 10px; /* Conserve les bords arrondis */
            }
            /* Carousel container */
            .carousel-container {
            position: relative;
            width: 100%;
            max-width: 400px; /* La largeur du carousel reste fixe */
            height: 500px; /* Hauteur plus grande */
            overflow: hidden; /* Garde les images confinées */
            border-radius: 10px;
            }
            .carousel-slide {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in-out; /* Effet de transition fluide */
            }
            .carousel-slide:nth-child(1) {
            opacity: 1; /* La première image s'affiche par défaut */
            }
            .carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Proportions respectées */
            }
            /* Button styles */
            .button {
            display: inline-block;
            margin-top: 15px;
            padding: 15px 30px;
            background-color: #FF69B4;
            color: white;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
            border: 2px solid #FF69B4;
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.2s ease;
            text-decoration: none;
            animation: pulse 1.5s infinite ease-in-out;
            }
            .button:hover {
            background-color: #FF1493; /* Rose plus foncé au survol */
            border-color: #FF1493;
            }
            /* Email input styles */
            .email-input-container {
            position: relative;
            width: 100%;
            max-width: 300px;
            margin-top: 20px;
            margin-bottom: 0px; /* Moins d’espace après le champ email */
            padding-bottom: 0px !important;
            }
            .email-input {
            width: 100%;
            padding: 15px;
            background-color: #2a2a2a; /* Gris clair pour le champ */
            border: none;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s ease;
            }
            .email-input::placeholder {
            color: #bbb; /* Placeholder gris plus clair */
            }
            .email-input:focus {
            background-color: #444; /* Un peu plus sombre au focus */
            outline: none;
            }
            .email-input-button {
            background-color: #FF69B4; /* Bouton rose moderne */
            padding: 15px;
            border: none;
            width: 100%;
            font-size: 16px;
            color: #fff;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            margin-top: 10px;
            transition: background-color 0.3s ease;
            }
            .email-input-button:hover {
            background-color: #FF1493; /* Bouton plus sombre au hover */
            }
            footer {
            background-color: #333;
            color: #bbb;
            padding: 10px;
            margin-top: auto; /* Positionne le footer en bas */
            text-align: center;
            }
            footer a {
            color: #FF69B4; /* Rose pour les liens */
            text-decoration: none;
            }
            footer a:hover {
            text-decoration: underline;
            }
            /* ✅ Réduit l’espace entre les images de la galerie et les autres sections */
            .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            justify-items: center; /* Center the elements in the grid */
            align-items: stretch; /* Ensure elements have the same height */
            margin-bottom: 0px; /* Réduction maximale sans être collé */
            margin-top: 0px !important;
            }
            /* ✅ Ajustement de l’espacement entre chaque image du scroll infini */
            .gallery-offer {
            background-color: #1e1e1e;
            border: 1px solid #444;
            border-radius: 10px;
            padding: 20px;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 400px; /* Limit width to avoid large blocks on PC */
            height: 100%; /* Ensure all sections have the same height */
            margin-bottom: 10px; /* Réduction de l’espace en dessous */
            }
            /* ✅ Réduction de l’espace sous les images */
            .gallery-offer img {
            width: 100%;
            max-height: 500px; /* Limite la hauteur de l'image */
            object-fit: cover; /* Adapte l'image sans la déformer */
            border-radius: 10px; /* Conserve les bords arrondis */
            }
            /* ✅ Réduction de l’espace entre les boutons et l’image */
            .gallery-offer .button-container {
            display: flex;
            justify-content: center;
            gap: 8px; /* Moins d’espace entre les boutons */
            margin-top: 10px; /* Moins d’espace entre l’image et les boutons */
            width: 100%;
            }
            /* ✅ Ajustement du footer pour qu’il ne remonte pas trop */
            footer {
            width: 100%;
            background-color: #333;
            color: #bbb;
            padding: 15px;
            text-align: center;
            position: relative;
            margin-top: 30px; /* Un peu d’espace, mais pas trop */
            }
            .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #FF69B4; /* Couleur flashy rose */
            text-align: center;
            margin-top: 30px;
            margin-bottom: 10px;
            }
            .gallery-description {
            font-size: 14px;
            color: #bbb;
            text-align: center;
            margin-bottom: 10px;
            }
            .gallery-description {
            font-size: 16px; /* Augmentation de la taille */
            font-weight: bold; /* Texte en gras */
            color: #ffffff; /* Rose plus clair */
            text-align: center;
            margin-bottom: 20px;
            background: rgba(255, 105, 180, 0.1); /* Légère couleur de fond */
            padding: 10px;
            border-radius: 0px;
            display: inline-block;
            }
            .patreon-description {
            font-size: 13px;
            color: #ffffff; /* Blanc pour une meilleure lisibilité */
            text-align: center;
            margin-top: 20px;
            opacity: 0.8; /* Légèrement atténué */
            max-width: 80%; /* ✅ Limite la largeur pour qu'elle reste sous le bouton */
            margin-left: auto;
            margin-right: auto;
            word-wrap: break-word; /* ✅ Évite que le texte dépasse */
            }
            /* ✅ Champ email */
            .popup-email-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: none;
            border-radius: 6px;
            text-align: center;
            ont-size: 14px;
            background-color: #2a2a2a;
            color: white;
            font-size: 16px; /* ✅ Empêche le zoom sur iOS */
            }
            /* ✅ Bouton du popup */
            .popup-container .popup-button {
            display: inline-block;
            padding: 10px 20px;
            background-color: #FF69B4;
            color: white;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            text-align: center;
            border: none;
            transition: background-color 0.3s ease;
            text-decoration: none;
            font-weight: bold;
            }
            .popup-container .popup-button:hover {
            background-color: #FF1493;
            }
            .counter-text {
            font-size: 14px;
            color: #fff;
            text-align: center;
            margin-bottom: 5px;
            font-weight: bold;
            }
            .info-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin-top: 10px;
            }
            .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            padding: 10px 0; /* Espace au-dessus et en dessous */
            margin-top: 20px; /* ✅ Ajoute de l’espace au-dessus */
            }
            .logo-container img {
            width: 90%;  /* ✅ Adapte la largeur au mobile sans dépasser */
            max-width: 200px; /* ✅ Ne dépasse pas cette largeur sur PC */
            height: auto; /* ✅ Garde les proportions */
            object-fit: contain;
            }
            .download-button {
            display: inline-block;
            margin-top: 10px;
            padding: 12px 20px;
            background-color: #FF69B4;
            color: white;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
            width: 100%;  /* Assure que les boutons prennent toute la largeur */
            }
            .download-button:hover {
            background-color: #FF1493;
            }
            /* ✅ Arrière-plan flou (overlay) */
            .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6); /* Fond semi-transparent */
            backdrop-filter: blur(8px); /* Effet de flou */
            display: none; /* Caché par défaut */
            align-items: center;
            justify-content: center;
            z-index: 1000;
            }
            /* ✅ Style du popup CENTRÉ */
            .popup-container {
            background-color: #1e1e1e;
            color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            text-align: center;
            width: 90%;
            max-width: 400px;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
            animation: fadeIn 0.3s ease-in-out;
            /* ✅ Correction pour éviter l'espace inutile en bas */
            max-height: 90vh;
            overflow-y: auto;
            }
            /* ✅ Ajustement pour mobile */
            @media screen and (max-width: 600px) {
            .popup-container {
            width: 90%;
            max-width: 350px;
            padding: 15px;
            }
            }
            /* ✅ Animation fluide */
            @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -55%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
            }
            /* ✅ Bouton de fermeture bien positionné */
            .popup-close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 20px;
            cursor: pointer;
            color: #ffffff;
            opacity: 0.8;
            z-index: 10;
            }
            .popup-close:hover {
            opacity: 1;
            }
            /* ✅ Style de la liste des avantages */
            .popup-benefits {
            text-align: left;
            margin: 15px 0;
            padding-left: 20px;
            list-style: none;
            }
            .popup-benefits li {
            font-size: 14px;
            margin-bottom: 5px;
            padding-left: 20px;
            position: relative;
            }
            /* ✅ Ajout d'une icône devant chaque point */
            .popup-benefits li::before {
            content: "✔️"; /* Emoji Checkmark */
            position: absolute;
            left: 0;
            }
            /* ✅ Style du bouton alternatif */
            .popup-alt-download {
            font-size: 13px;
            margin-top: 15px;
            color: #bbb;
            }
            /* ✅ Style de l'image du popup */
            .popup-image {
            width: 100%; /* Prend toute la largeur du popup */
            max-width: 300px; /* Taille max pour ne pas être trop grande */
            display: block;
            margin: 0 auto 15px; /* Centrage + espace sous l'image */
            border-radius: 8px; /* Coins arrondis pour un meilleur rendu */
            }
            .popup-alt-button {
            display: inline-block;
            margin-top: 5px;
            padding: 8px 15px;
            background-color: #444;
            color: white;
            border-radius: 6px;
            font-size: 14px;
            text-decoration: none;
            font-weight: bold;
            transition: background-color 0.3s ease;
            }
            .popup-alt-button:hover {
            background-color: #666;
            }
            .no-scroll {
            overflow: hidden;
            height: 100vh;
            }
            /* ✅ Style du bouton Download in HD (gris) */
            .download-button-hd {
            background-color: #555; /* Gris foncé */
            color: #ddd; /* Texte gris clair */
            border: 2px solid #777; /* Bordure légèrement plus claire */
            transition: background-color 0.3s ease, border-color 0.3s ease;
            }
            .download-button-hd:hover {
            background-color: #666; /* Gris plus clair au survol */
            border-color: #888;
            }
            /* ✅ Style du bouton Download in 4K (rose pour mettre en avant) */
            .download-button-4k {
            background-color: #FF69B4; /* Rose flashy */
            color: white;
            border: 2px solid #FF69B4;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            }
            .download-button-4k:hover {
            background-color: #FF1493; /* Rose plus foncé au survol */
            border-color: #FF1493;
            }
            /* ✅ Style du bouton pour remonter en haut */
            .scroll-top-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background-color: #FF69B4; /* Rose flashy */
            border: none;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            transition: opacity 0.3s ease-in-out, transform 0.2s ease;
            z-index: 1000;
            }
            /* ✅ Effet au survol */
            .scroll-top-button:hover {
            background-color: #FF1493; /* Rose plus foncé */
            transform: scale(1.1);
            }
            /* ✅ Style spécifique pour l'icône SVG */
            .scroll-top-button svg {
            width: 24px;
            height: 24px;
            stroke: white; /* ✅ Flèche blanche */
            }
            /* ✅ Conteneur de la barre de recherche */
            .search-container {
    display: flex;
    justify-content: center; /* ✅ Centre la barre */
    align-items: center;
    margin: 20px auto; /* ✅ Ajoute un peu d'espace autour */
    width: 90%;
    max-width: 600px;
    background-color: #1e1e1e;
    padding: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    border-radius: 10px;
}

            /* ✅ Barre de recherche */
            .search-bar {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #FF69B4;
            border-radius: 8px;
            background-color: #1e1e1e;
            color: white;
            text-align: center;
            }
            /* ✅ Style du titre */
            .image-title {
            font-size: 18px;
            font-weight: bold;
            color: #FF69B4; /* Rose flashy */
            margin: 10px 0;
            }
            /* ✅ Style de la description */
            .image-description {
            font-size: 14px;
            color: #bbb;
            margin: 5px 0;
            text-align: center;
            padding: 0 10px;
            }
            /* ✅ Conteneur des tags */
            .tags-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            margin-bottom: 10px;
            }
            /* ✅ Style des tags */
            .tag {
            background-color: #FF69B4;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
            }
            /* ✅ Style des tags */
            .tag {
            background-color: #FF69B4;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer; /* ✅ Rend le tag cliquable */
            transition: background-color 0.2s ease-in-out;
            }
            /* ✅ Effet au survol */
            .tag:hover {
            background-color: #FF1493;
            }
            /* ✅ Effet quand un tag est actif (cliqué) */
            .tag.active {
            background-color: #FF1493;
            border: 2px solid white;
            }
            /* ✅ Ajuste la position du contenu sous la barre */
        </style>
    </head>
    <body>
        <!-- ✅ Bouton de retour en haut -->
        <button id="scrollTopButton" class="scroll-top-button">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="18 15 12 9 6 15"></polyline>
            </svg>
        </button>
        <div class="logo-container">
            <a href="https://kawaiify.art">
            <img src="https://i.ibb.co/rfGqdvc6/Logo-test.png" alt="Kawaiify Logo">
            </a>
        </div>

        <!-- ✅ Barre de recherche -->
        <div class="search-container">
            <input type="text" id="searchBar" class="search-bar" placeholder="🔍 Search wallpapers...">
        </div>

        <!-- ✅ Popup 4K Centered -->
        <div class="popup-overlay" id="popup-4k-overlay">
            <div class="popup-container" id="popup-4k">
                <span class="popup-close" onclick="closePopup4K()">✖</span>
                <!-- ✅ Image d'illustration 4K vs HD -->
                <img src="https://i.ibb.co/mV3h967M/adzdazzdaazdazd.png" alt="4K vs HD Comparison" class="popup-image">
                <!-- ✅ Titre du popup -->
                <h3>🎁 Download Your 4K Anime Wallpaper!</h3>
                <!-- ✅ Description rapide -->
                <p>Enter your email to <strong>instantly download this wallpaper in ultra-sharp 4K</strong> and get exclusive benefits:</p>
                <!-- ✅ Liste des avantages -->
                <ul class="popup-benefits">
                    <li>Receive a <strong>new exclusive 4K wallpaper</strong> every week.</li>
                    <li>Get <strong>tips on how to create your own anime wallpapers</strong>.</li>
                    <li>Learn <strong>how to monetize your Pinterest with anime wallpapers</strong>.</li>
                </ul>
                <!-- ✅ Formulaire d'inscription -->
                <form id="popup-4k-form" action="https://form.flodesk.com/forms/679762dbb32b1d435468220c/submit" method="POST">
                    <input type="email" name="email" class="popup-email-input" placeholder="Enter your email" required>
                    <button type="submit" class="popup-button">📥 Download in 4K (Free)</button>
                </form>
                <!-- ✅ Option sans email -->
                <p class="popup-alt-download">Prefer not to enter your email? <br>
                    <a href="#" id="download-hd-button" class="popup-alt-button" data-url="">Download in HD (No email)</a>
                </p>
            </div>
        </div>
        <!-- Offers sections -->
        <div class="offers">
            <!-- Free Pack Offer -->
            <div class="offer" id="free-offer-section">
                <h2>Unlock 100+ Stunning 4K Wallpapers for Free!</h2>
                <p>Get a free pack of over <strong>100 high-quality anime wallpapers</strong> in <strong>ultra-sharp 4K</strong> resolution to enhance your device! 📲</p>
                <img src="https://i.ibb.co/FmT37qd/Banner-Patreon-Website-V2.png" alt="Free pack preview">
                <div class="email-input-container">
                    <form id="email-form" action="https://form.flodesk.com/forms/679762dbb32b1d435468220c/submit" method="POST">
                        <input type="email" name="email" class="email-input" placeholder="Enter your email" required>
                        <button type="submit" id="email-submit-button" class="email-input-button">Claim Your Free Pack</button>
                    </form>
                </div>
            </div>
        </div>
        </div>
        <h2 class="section-title">Latest Wallpapers</h2>
        <p class="gallery-description">💎 Unlock all the high-definition <strong>wallpapers</strong> and upgrade your screen for free!</p>
        <div class="gallery" id="gallery"></div>
        <footer>
            <p>&copy; 2025 Kawaiify | <a href="https://tonsite.com/privacy">Privacy Policy</a></p>
        </footer>
        <script>
            // ✅ Fonction pour filtrer les images
            function filterImages() {
            console.log("🔎 Filtrage en cours...");
            const searchInput = document.getElementById("searchBar").value.toLowerCase().trim();
            const searchTerms = searchInput.split(" ").filter(Boolean); // Liste des mots-clés actifs
            
            const galleryItems = document.querySelectorAll(".gallery-offer");
            
            galleryItems.forEach(item => {
            const title = item.querySelector(".image-title") ? item.querySelector(".image-title").textContent.toLowerCase() : "";
            const description = item.querySelector(".image-description") ? item.querySelector(".image-description").textContent.toLowerCase() : "";
            const tags = Array.from(item.querySelectorAll(".tag")).map(tag => tag.textContent.toLowerCase());
            
            if (searchTerms.length === 0) {
               item.style.display = "block"; // ✅ Si aucune recherche active, on affiche tout
               return;
            }
            
            // ✅ Vérifie si TOUS les tags sélectionnés sont dans les tags de l'image
            const allTagsMatch = searchTerms.every(term => 
               title.includes(term) || 
               description.includes(term) || 
               tags.includes(term)
            );
            
            item.style.display = allTagsMatch ? "block" : "none"; // ✅ Affiche seulement si tous les tags sont présents
            });
            
            console.log("✅ Filtrage terminé !");
            }
            
            
            
            // ✅ Fonction pour filtrer les images en cliquant sur un tag
            function filterByTag(tag) {
            console.log(`🔎 Filtrage par tag: ${tag}`);
            
            const searchBar = document.getElementById("searchBar");
            if (!searchBar) {
            console.error("❌ ERREUR: La barre de recherche est introuvable !");
            return;
            }
            
            let searchTerms = searchBar.value.toLowerCase().trim().split(" ").filter(Boolean); // Convertit en tableau de mots clés
            
            if (searchTerms.includes(tag.toLowerCase())) {
            // ✅ Si le tag est déjà dans la recherche, on l'enlève
            searchTerms = searchTerms.filter(t => t !== tag.toLowerCase());
            } else {
            // ✅ Sinon, on l'ajoute
            searchTerms.push(tag.toLowerCase());
            }
            
            searchBar.value = searchTerms.join(" "); // Met à jour la barre de recherche avec les tags sélectionnés
            
            if (searchTerms.length === 0) {
            searchBar.value = ""; // ✅ Si plus aucun tag n'est sélectionné, on vide la barre
            }
            
            filterImages(); // Relance le filtrage
            }
            
            
            
            document.addEventListener("DOMContentLoaded", function () {
                document.querySelectorAll('.patreon-track').forEach(button => {
                    button.addEventListener("click", function () {
                        gtag("event", "click", {
                            event_category: "Buttons",
                            event_label: "Patreon",
                            value: 1
                        });
                    });
                });
            
                document.querySelectorAll("#email-submit-button, .popup-button").forEach(button => {
                    button.addEventListener("click", function () {
                        gtag("event", "sign_up", {
                            event_category: "Forms",
                            event_label: "Email Submission",
                            value: 1
                        });
                    });
                });
            });
            
            document.addEventListener("DOMContentLoaded", function () {
                const lazyImages = document.querySelectorAll("img[loading='lazy']");
            
                const observer = new IntersectionObserver(
                    (entries, observer) => {
                        entries.forEach((entry) => {
                            if (entry.isIntersecting) {
                                const img = entry.target;
                                img.src = img.dataset.src; // Remplace l'attribut data-src par src
                                observer.unobserve(img);
                            }
                        });
                    },
                    { rootMargin: "100px" } // Déclenche un peu avant l'affichage
                );
            
                lazyImages.forEach((img) => {
                    observer.observe(img);
                });
            });
            
            document.addEventListener("DOMContentLoaded", function () {
            let isLoading = false;
            const imagesPerLoad = 10;
            let loadedImages = new Set();
            const gallery = document.getElementById("gallery");
            let imageUrls = [];
            let nextImageIndex = 0;
            
            // ✅ Vérifie si l'utilisateur a déjà soumis son email
            function hasSubmittedEmail() {
            return localStorage.getItem("emailSubmitted") === "true";
            }
            
            // ✅ Sauvegarde l'état après soumission du formulaire
            function setEmailSubmitted() {
            localStorage.setItem("emailSubmitted", "true");
            }
            
            // ✅ Sélectionne le bouton "Download in HD (No email)" dans le popup
            let downloadHdPopupButton = document.getElementById("download-hd-button");
            
            // ✅ Met à jour le bouton "Download in HD (No email)" pour télécharger la bonne image
            function setPopupDownloadUrl(imageUrlHD, imageUrl4K) {
            if (downloadHdPopupButton) {
            // ✅ Remplace le bouton pour éviter les anciens écouteurs
            const newDownloadButton = downloadHdPopupButton.cloneNode(true);
            downloadHdPopupButton.replaceWith(newDownloadButton);
            downloadHdPopupButton = newDownloadButton;
            
            // ✅ Télécharge la version HD (et pas 4K !)
            downloadHdPopupButton.addEventListener("click", function (event) {
            event.preventDefault();
            forceDownload(imageUrlHD); // 🔥 On force le téléchargement HD
            closePopup4K();
            });
            }
            }
            
            
            // ✅ Forcer le téléchargement direct de l'image
            async function forceDownload(imageUrl) {
            try {
            const response = await fetch(imageUrl);
            const blob = await response.blob();
            const blobUrl = window.URL.createObjectURL(blob);
            
            const a = document.createElement("a");
            a.href = blobUrl;
            a.download = "wallpaper.jpg";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            setTimeout(() => {
                window.URL.revokeObjectURL(blobUrl);
            }, 1000);
            } catch (error) {
            console.error("❌ Erreur lors du téléchargement de l’image :", error);
            }
            }
            
            
            // ✅ Fonction pour charger les images avec tags cliquables
            async function fetchImages() {
            if (isLoading || nextImageIndex >= imageUrls.length) return;
            isLoading = true;
            
            try {
            const imagesToLoad = imageUrls.slice(nextImageIndex, nextImageIndex + imagesPerLoad);
            nextImageIndex += imagesPerLoad;
            
            imagesToLoad.forEach(imgData => {
            if (!loadedImages.has(imgData.url)) {
                loadedImages.add(imgData.url);
            
                const offerDiv = document.createElement("div");
                offerDiv.className = "offer gallery-offer";
            
                // ✅ Image
                const imgElement = document.createElement("img");
                imgElement.src = imgData.url;
                imgElement.alt = imgData.title;
                imgElement.loading = "lazy";
            
                // ✅ Titre
                const titleElement = document.createElement("h3");
                titleElement.className = "image-title";
                titleElement.textContent = imgData.title;
            
                // ✅ Description
                const descriptionElement = document.createElement("p");
                descriptionElement.className = "image-description";
                descriptionElement.textContent = imgData.description;
            
                // ✅ Génération des tags cliquables
            const tagsContainer = document.createElement("div");
            tagsContainer.className = "tags-container";
            imgData.tags.forEach(tag => {
            const tagSpan = document.createElement("span");
            tagSpan.className = "tag";
            tagSpan.textContent = tag;
            
            // ✅ Active/Désactive le tag au clic
            tagSpan.addEventListener("click", function () {
            this.classList.toggle("active"); // Change l'état du tag visuellement
            filterByTag(tag); // Applique le filtrage
            });
            
            tagsContainer.appendChild(tagSpan);
            });
            
                // ✅ Compteur de téléchargements
                let storedCount = localStorage.getItem(`clickCount_${imgData.url}`);
                if (storedCount === null) {
                    storedCount = Math.floor(Math.random() * (15000 - 900 + 1)) + 900;
                    localStorage.setItem(`clickCount_${imgData.url}`, storedCount);
                }
            
                const downloadCounter = document.createElement("p");
                downloadCounter.className = "counter-text";
                downloadCounter.innerHTML = `🔥 Downloaded by ${storedCount.toLocaleString()} people!`;
            
            
                // ✅ Bouton HD
                const downloadButtonHD = document.createElement("button");
                downloadButtonHD.className = "download-button download-button-hd";
                downloadButtonHD.innerHTML = "<strong>Download in HD</strong>";
                downloadButtonHD.addEventListener("click", function () {
                    forceDownload(imgData.url);
                });
            
                // ✅ Bouton 4K (popup)
                const download4KButtonPopup = document.createElement("button");
                download4KButtonPopup.className = "download-button download-button-4k";
                download4KButtonPopup.innerHTML = "<strong>Download in 4K (Free)</strong>";
                download4KButtonPopup.addEventListener("click", function () {
            openPopup4K(imgData.url, imgData.url_4k); // 🔥 On passe les 2 URL : HD et 4K
            });
            
                // ✅ Ajout des éléments
                offerDiv.appendChild(imgElement);
                offerDiv.appendChild(titleElement);
                offerDiv.appendChild(descriptionElement);
                offerDiv.appendChild(tagsContainer);
                offerDiv.appendChild(downloadCounter);
                offerDiv.appendChild(downloadButtonHD);
                offerDiv.appendChild(download4KButtonPopup);
            
                gallery.appendChild(offerDiv);
            }
            });
            } catch (error) {
            console.error("❌ Erreur lors du chargement des images :", error);
            }
            
            isLoading = false;
            }
            
            
            
            
            
            
            // ✅ Fonction pour charger les images initiales
            async function loadInitialImages() {
            try {
            const response = await fetch("https://raw.githubusercontent.com/ValentinGird/Kawaiify_Beta/main/images.json");
            if (!response.ok) throw new Error("❌ Problème de récupération du fichier JSON");
            
            const data = await response.json();
            imageUrls = data.images;
            
            if (!imageUrls || imageUrls.length === 0) {
                console.warn("⚠️ Aucune image trouvée !");
                return;
            }
            
            fetchImages();
            } catch (error) {
            console.error("❌ Erreur lors de la récupération du fichier JSON :", error);
            }
            }
            
            loadInitialImages();
            
            // ✅ Chargement infini sur scroll
            window.addEventListener("scroll", function () {
            if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 500) {
            fetchImages();
            }
            });
            
            // ✅ Fonction pour ouvrir le popup 4K ou télécharger directement
            function openPopup4K(imageUrlHD, imageUrl4K) {
            if (hasSubmittedEmail()) {
            forceDownload(imageUrl4K); // ✅ Si déjà inscrit, on télécharge directement en 4K
            } else {
            const popup = document.getElementById("popup-4k");
            const overlay = document.getElementById("popup-4k-overlay");
            
            if (popup && overlay) {
            popup.style.display = "block";
            overlay.style.display = "flex";
            
            setPopupDownloadUrl(imageUrlHD, imageUrl4K); // ✅ Passe les 2 URL
            document.body.style.overflow = "hidden";
            }
            }
            }
            
            // ✅ Fonction pour fermer le popup 4K et réactiver le scrolling
            function closePopup4K() {
            const popup = document.getElementById("popup-4k");
            const overlay = document.getElementById("popup-4k-overlay");
            
            if (popup && overlay) {
            popup.style.display = "none";
            overlay.style.display = "none";
            
            document.body.style.overflow = "";
            }
            }
            
            // ✅ Capture la soumission du formulaire pour masquer définitivement le popup
            document.getElementById("popup-4k-form").addEventListener("submit", function () {
            setEmailSubmitted(); // ✅ Marque l'email comme soumis
            closePopup4K(); // ✅ Ferme le popup après soumission
            });
            
            // ✅ Ferme le popup si on clique sur l'overlay
            document.getElementById("popup-4k-overlay").addEventListener("click", function (event) {
            if (event.target === this) {
            closePopup4K();
            }
            });
            
            // ✅ Ferme le popup quand on clique sur la croix (✖)
            document.querySelector(".popup-close").addEventListener("click", function () {
            closePopup4K();
            });
            });
            
            
            document.addEventListener("DOMContentLoaded", function () {
    const emailInput = document.querySelector(".popup-email-input"); // Sélectionne l'input email

    if (emailInput) {
        emailInput.addEventListener("focus", function () {
            setTimeout(() => {
                emailInput.scrollIntoView({ behavior: "smooth", block: "center" });
            }, 300); // Petit délai pour éviter les bugs de transition
        });
    }
});
            
            
            
            document.addEventListener("DOMContentLoaded", function () {
            const scrollTopButton = document.getElementById("scrollTopButton");
            
            // ✅ Affiche le bouton quand on scrolle vers le bas
            window.addEventListener("scroll", function () {
            if (window.scrollY > 300) { // Affiche à partir de 300px de scroll
            scrollTopButton.style.display = "block";
            } else {
            scrollTopButton.style.display = "none";
            }
            });
            
            // ✅ Scroll smooth vers le haut quand on clique sur la flèche
            scrollTopButton.addEventListener("click", function () {
            window.scrollTo({
            top: 0,
            behavior: "smooth"
            });
            });
            });
            
            
            function filterByTag(tag) {
            console.log(`🔎 Filtrage par tag: ${tag}`);
            
            const searchBar = document.getElementById("searchBar");
            if (!searchBar) {
            console.error("❌ ERREUR: La barre de recherche est introuvable !");
            return;
            }
            
            let searchTerms = searchBar.value.toLowerCase().trim().split(" ").filter(Boolean); // Convertit en tableau de mots clés
            
            if (searchTerms.includes(tag.toLowerCase())) {
            // ✅ Si le tag est déjà dans la recherche, on l'enlève
            searchTerms = searchTerms.filter(t => t !== tag.toLowerCase());
            } else {
            // ✅ Sinon, on l'ajoute
            searchTerms.push(tag.toLowerCase());
            }
            
            searchBar.value = searchTerms.join(" "); // Met à jour la barre de recherche avec les tags sélectionnés
            
            if (searchTerms.length === 0) {
            searchBar.value = ""; // ✅ Si plus aucun tag n'est sélectionné, on vide la barre
            }
            
            filterImages(); // Relance le filtrage
            }
            
            
            
            
            document.addEventListener("DOMContentLoaded", function () {
            console.log("✅ Barre de recherche activée...");
            
            const searchBar = document.getElementById("searchBar");
            const gallery = document.getElementById("gallery");
            
            if (!searchBar || !gallery) {
            console.error("❌ ERREUR: Élément introuvable !");
            return;
            }
            
            function filterImages() {
            console.log("🔎 Filtrage en cours...");
            const searchInput = document.getElementById("searchBar").value.toLowerCase().trim();
            const searchTerms = searchInput.split(" ").filter(Boolean); // Liste des mots-clés actifs
            
            const galleryItems = document.querySelectorAll(".gallery-offer");
            
            galleryItems.forEach(item => {
            const title = item.querySelector(".image-title") ? item.querySelector(".image-title").textContent.toLowerCase() : "";
            const description = item.querySelector(".image-description") ? item.querySelector(".image-description").textContent.toLowerCase() : "";
            const tags = Array.from(item.querySelectorAll(".tag")).map(tag => tag.textContent.toLowerCase());
            
            if (searchTerms.length === 0) {
               item.style.display = "block"; // ✅ Si aucune recherche active, on affiche tout
               return;
            }
            
            // ✅ Vérifie si TOUS les tags sélectionnés sont dans les tags de l'image
            const allTagsMatch = searchTerms.every(term => 
               title.includes(term) || 
               description.includes(term) || 
               tags.includes(term)
            );
            
            item.style.display = allTagsMatch ? "block" : "none"; // ✅ Affiche seulement si tous les tags sont présents
            });
            
            console.log("✅ Filtrage terminé !");
            }
            
            
            
            
            
            searchBar.addEventListener("input", filterImages);
            });
            
            
            
            
            document.addEventListener("DOMContentLoaded", function () {
                console.log("📊 Google Analytics Debug: Tracking initialized ✅");
            
                // ✅ Vérifie si gtag est bien défini avant d'envoyer des événements
                if (typeof gtag !== "function") {
                    console.error("❌ Google Analytics (gtag) n'est pas défini !");
                    return;
                }
            
                // ✅ Track les clics sur les boutons Patreon
                document.body.addEventListener("click", function (event) {
                    let button = event.target.closest(".patreon-track");
                    if (button) {
                        gtag("event", "click", {
                            event_category: "Buttons",
                            event_label: "Patreon Click",
                            value: 1
                        });
                        console.log("📊 Patreon click tracked! ✅");
                    }
                });
            
                // ✅ Track les soumissions d'email (form principal + popup)
                document.querySelectorAll("#email-form, #popup-email-form").forEach(form => {
                    form.addEventListener("submit", function (event) {
                        event.preventDefault();
                        gtag("event", "sign_up", {
                            event_category: "Forms",
                            event_label: "Email Submission",
                            value: 1
                        });
                        console.log("📊 Email submission tracked! ✅");
                        form.submit();
                    });
                });
            
                // ✅ Test event pour vérifier si Google Analytics fonctionne
                gtag("event", "test_event", {
                    event_category: "Debug",
                    event_label: "Test Event",
                    value: 1
                });
                console.log("📊 Test event sent to Google Analytics ✅");
            });
            
                
        </script>
    </body>
</html>